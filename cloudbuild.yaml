steps:
  # Paso 1: Instalar dependencias
  - name: 'python:3.9'
    id: install-deps
    entrypoint: pip
    args: ['install', '-r', 'requirements.txt']
  
  # Paso 2: Ejecutar el pipeline
  - name: 'python:3.9'
    id: run-pipeline
    entrypoint: python
    args: 
      - 'pipeline.py'
      - '--bucket=beam_dataflow_cl'
      - '--file=origin/data.csv'
  
  # Paso 3: Subir resultados a Cloud Storage
  - name: 'gcr.io/google.com/cloudsdktool/cloud-sdk'
    id: upload-results
    entrypoint: bash
    args:
      - '-c'
      - |
        # Crear archivo con timestamp
        echo "Ejecución completada en $(date)" > output.txt
        
        # Subir a Cloud Storage
        gsutil cp output.txt gs://${PROJECT_ID}-pipeline-output/output-${BUILD_ID}.txt

# SOLUCIÓN AL ERROR: Configuración de logging requerida
options:
  logging: CLOUD_LOGGING_ONLY  # Opción recomendada para logs en Cloud Logging